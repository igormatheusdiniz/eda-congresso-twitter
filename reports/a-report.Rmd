---
title: "REPLACE ME"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
source(here::here("code/lib.R"))
theme_set(theme_bw())
```

```{r read}
atividade = read_projectdata()

atividade = atividade %>% 
  filter(seguidores > 0, n_proprio > 0, n_retweet > 0)

```

# 1. Qual a relação entre as características da atuação do parlamentar e o engajamento total que ele obtém no twitter? 

Por "características", queremos dizer: qual a casa (senado/câmara) do parlamentar, quantas pessoas ele segue, por quantas ele é seguido, quanto ele tuíta e quanto ele retuíta.

## Análises

### Relação Seguidores vs. Engajamento total

```{r}
atividade %>% 
  ggplot(aes(x = seguidores, y = engaj_total)) + 
  geom_point()

atividade %>% 
  ggplot(aes(x = seguidores, y = engaj_total)) + 
  geom_point() + 
  scale_y_log10() + 
  scale_x_log10()

```

### Relação Casa vs. Engajamento total
```{r}
atividade %>% 
  ggplot(aes(x = casa, y = engaj_total)) + 
  geom_point()
```

### Relação Pessoa que segue  vs. Engajamento total
```{r}
atividade %>% 
  ggplot(aes(x = segue, y = engaj_total)) + 
  geom_point()

atividade %>% 
  ggplot(aes(x = segue, y = engaj_total)) + 
  geom_point() + 
  scale_y_log10() + 
  scale_x_log10()

```

### Relação Twites próprios vs. Engajamento total

```{r}
atividade %>% 
  ggplot(aes(x = n_proprio, y = engaj_total)) + 
  geom_point()

atividade %>% 
  ggplot(aes(x = n_proprio, y = engaj_total)) + 
  geom_point() + 
  scale_y_log10() + 
  scale_x_log10()

```

### Relação Nº de Retweets vs. Engajamento total

```{r}
atividade %>% 
  ggplot(aes(x = n_retweet, y = engaj_total)) + 
  geom_point()

atividade %>% 
  ggplot(aes(x = n_retweet, y = engaj_total)) + 
  geom_point() + 
  scale_y_log10() + 
  scale_x_log10()

```

Podemos perceber que para todas as Análises descritivas só foi possível perceber e compreender melhor o que estava acontecendo quand houve uma transformação para escala logarítimica, isso aconteceu porque dificilmente as relações do mundo são lineares.

## Criando o modelo

```{r}
atividade = atividade %>% 
  mutate(seguidores_log = log10(seguidores), 
         engaj_total_log = log10(engaj_total),
         segue_log = log10(segue),
         n_proprio_log = log10(n_proprio),
         n_retweet_log = log10(n_retweet))
```


```{r}
modelo = lm(engaj_total_log ~ seguidores_log + segue_log + n_proprio_log + n_retweet_log + casa, 
   data = atividade)

tidy(modelo)
```

```{r}
para_plotar_modelo = atividade %>% 
  data_grid(seguidores_log = mean(seguidores_log),
            segue_log = mean(segue_log),
            engaj_total_log = seq_range(engaj_total_log, 10),
            n_proprio_log = seq_range(n_proprio_log, 10), # Crie um vetor de 10 valores no range
            n_retweet_log = mean(n_retweet_log), # todos na média
            casa = "senado") %>% 
  add_predictions(modelo)

glimpse(para_plotar_modelo)
```

```{r}
ggplot(data = atividade, aes(x = engaj_total_log)) + 
  geom_point(aes(y = seguidores_log)) + 
  geom_line(data = para_plotar_modelo, aes(y = pred), color = "orange", size = 1.5)
```

```{r}
ggplot(data = atividade, aes(x = 10**engaj_total_log)) + 
  # geom_point(aes(y = 10**seguidores_log)) + 
  geom_line(data = para_plotar_modelo, aes(y = 10**pred), color = "orange", size = 1.5)
```

## Conclusão
Regressão linear múltipla foi utilizada para analisar a associação entre Engajamento total, VarIndep2, ..., e VarDep. Os resultados da regressão indicam que um modelo no formato VarDep = XXX.VarIndep1 + YYY explicam XX,XX% da variância da variável de resposta (R2 = XX,XX). O aumento de 1 unidade de VarIndep1 medida como/em [unidade] produz uma mudança de xxx em VarDep. Portanto...

